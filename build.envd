# syntax=v1


def basic():
    install.cuda(version="11.6.2")
    install.python()
    install.python_packages(requirements="requirements-modelz.txt")


def build():
    base(dev=True)
    basic()
    runtime.expose(envd_port=8000, host_port=8000, service="sd")


def serving():
    basic()
    io.copy("modelz_server.py", ".")
    run(["python modelz_server.py --dry-run"])
    config.entrypoint(["python", "modelz_server.py", "--timeout", "30000"])
